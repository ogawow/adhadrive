<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç¢„Éâ„Éè„Éâ„É©„Ç§„Éñ - ADHDÂêë„ÅëÂçîÂÉç„Çø„Çπ„ÇØÁÆ°ÁêÜ„Ç¢„Éó„É™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background-color: #f5f5f5;
            min-height: 100vh;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #1A1A1A;
        }
        
        .subtitle {
            font-size: 14px;
            text-align: center;
            color: #666;
            margin-bottom: 20px;
        }
        
        .trust-container {
            margin-bottom: 30px;
        }
        
        .trust-label {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #1A1A1A;
        }
        
        .trust-bar {
            height: 8px;
            background-color: #E0E0E0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .trust-progress {
            height: 8px;
            background-color: #00C851;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .invite-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .invite-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #1A1A1A;
        }
        
        .invite-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .invite-button {
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .invite-button:hover {
            background-color: #218838;
        }
        
        .invited-users {
            margin-top: 10px;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 4px;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .user-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .status-watching {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .status-notified {
            background-color: #fff3e0;
            color: #f57c00;
        }
        
        .record-button {
            background-color: #007AFF;
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 30px;
            border: none;
            transition: background-color 0.3s ease;
            width: 100%;
        }
        
        .record-button:hover {
            background-color: #0056CC;
        }
        
        .record-button:active {
            transform: scale(0.98);
        }
        
        .tasks-container {
            margin-bottom: 20px;
        }
        
        .tasks-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #1A1A1A;
        }
        
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .task-content {
            flex: 1;
        }
        
        .task-actions {
            display: flex;
            gap: 5px;
        }
        
        .task-button {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .start-button {
            background-color: #ffc107;
            color: #000;
        }
        
        .complete-button {
            background-color: #28a745;
            color: white;
        }
        
        .task-status {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
        }
        
        .status-pending {
            background-color: #e9ecef;
            color: #6c757d;
        }
        
        .status-in-progress {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-completed {
            background-color: #d4edda;
            color: #155724;
        }
        
        .stats-container {
            margin-bottom: 20px;
        }
        
        .stats-title {
            font-size: 16px;
            font-weight: bold;
            color: #1A1A1A;
        }
        
        .stats-subtitle {
            font-size: 14px;
            color: #666666;
            margin-top: 5px;
        }
        
        /* Á∑äÊÄ•„É¢„Éº„Éâ„ÅÆ„Çπ„Çø„Ç§„É´ */
        .emergency-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #FF3B30;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 1000;
        }
        
        .warning-container {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .warning-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .warning-title {
            font-size: 28px;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 10px;
        }
        
        .warning-subtitle {
            font-size: 18px;
            color: #FFFFFF;
        }
        
        .emergency-button {
            background-color: #FFFFFF;
            color: #FF3B30;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 40px;
            border: none;
            transition: transform 0.2s ease;
        }
        
        .emergency-button:hover {
            transform: scale(1.05);
        }
        
        .countdown-container {
            margin-bottom: 40px;
            text-align: center;
        }
        
        .countdown-label {
            font-size: 32px;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            height: 12px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress {
            height: 12px;
            background-color: #FFFFFF;
            border-radius: 6px;
            transition: width 0.1s ease;
        }
        
        .warning-list {
            text-align: center;
        }
        
        .warning-item {
            font-size: 18px;
            color: #FFFFFF;
            margin-bottom: 5px;
        }
        
        /* Ë®òÈå≤‰∏≠ÁîªÈù¢„ÅÆ„Çπ„Çø„Ç§„É´ */
        .recording-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #007AFF;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 1000;
        }
        
        .recording-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .recording-title {
            font-size: 24px;
            font-weight: bold;
            color: #FFFFFF;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .recording-subtitle {
            font-size: 18px;
            color: #FFFFFF;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .stop-button {
            background-color: #FFFFFF;
            color: #007AFF;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 40px;
            border: none;
            transition: transform 0.2s ease;
        }
        
        .stop-button:hover {
            transform: scale(1.05);
        }
        
        .pulse {
            animation: pulse 0.6s ease-in-out infinite alternate;
        }
        
        .shake {
            animation: shake 0.1s ease-in-out infinite;
        }
        
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px;
            border-radius: 8px;
            z-index: 2000;
            display: none;
        }
        
        /* „Çø„Çπ„ÇØËøΩÂä†„É¢„Éº„ÉÄ„É´ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1500;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #1A1A1A;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #1A1A1A;
        }
        
        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #007AFF;
        }
        
        .form-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 16px;
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: #007AFF;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .btn-primary {
            background-color: #007AFF;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0056CC;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .priority-selector {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .priority-option {
            flex: 1;
            padding: 10px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .priority-option.selected {
            border-color: #007AFF;
            background-color: #e3f2fd;
            color: #007AFF;
        }
        
        .priority-option.low {
            border-color: #28a745;
        }
        
        .priority-option.low.selected {
            background-color: #d4edda;
            color: #28a745;
        }
        
        .priority-option.medium {
            border-color: #ffc107;
        }
        
        .priority-option.medium.selected {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .priority-option.high {
            border-color: #dc3545;
        }
        
        .priority-option.high.selected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        /* ‰æùÈ†ºËÄÖ„Ç¢„Ç§„Ç≥„É≥ */
        .requester-info {
            margin-top: 10px;
        }
        
        .requester-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 5px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .requester-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .requester-name {
            font-weight: bold;
            color: #1A1A1A;
        }
        
        .requester-status {
            font-size: 12px;
            color: #666;
            margin-left: auto;
        }
        
        /* „Çø„Çπ„ÇØÂÜÖ„ÅÆ‰æùÈ†ºËÄÖ„Ç¢„Ç§„Ç≥„É≥ */
        .task-requester {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .task-requester-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .task-requester-name {
            font-size: 12px;
            color: #666;
            font-weight: bold;
        }
        
        /* Á∑äÊÄ•Â∫¶„Å´„Çà„Çã„Ç¢„Ç§„Ç≥„É≥„Çµ„Ç§„Ç∫Â§âÂåñ */
        .requester-avatar.urgent {
            width: 80px;
            height: 80px;
            border-color: #FF3B30;
            box-shadow: 0 0 15px rgba(255, 59, 48, 0.5);
            animation: urgentPulse 0.5s ease-in-out infinite alternate;
        }
        
        .requester-avatar.very-high {
            width: 70px;
            height: 70px;
            border-color: #FF6B35;
            box-shadow: 0 0 12px rgba(255, 107, 53, 0.4);
            animation: urgentPulse 0.8s ease-in-out infinite alternate;
        }
        
        .requester-avatar.high-priority {
            width: 60px;
            height: 60px;
            border-color: #dc3545;
            box-shadow: 0 0 10px rgba(220, 53, 69, 0.3);
        }
        
        .requester-avatar.medium-priority {
            width: 50px;
            height: 50px;
            border-color: #ffc107;
            box-shadow: 0 0 6px rgba(255, 193, 7, 0.2);
        }
        
        .requester-avatar.low-priority {
            width: 40px;
            height: 40px;
            border-color: #28a745;
        }
        
        @keyframes urgentPulse {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
        
        /* „Çø„Çπ„ÇØÂÜÖ„ÅÆ„Ç¢„Ç§„Ç≥„É≥„Çµ„Ç§„Ç∫Â§âÂåñ */
        .task-requester-avatar.urgent {
            width: 48px;
            height: 48px;
            border-color: #FF3B30;
            box-shadow: 0 0 12px rgba(255, 59, 48, 0.4);
            animation: urgentPulse 0.5s ease-in-out infinite alternate;
        }
        
        .task-requester-avatar.very-high {
            width: 42px;
            height: 42px;
            border-color: #FF6B35;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.3);
            animation: urgentPulse 0.8s ease-in-out infinite alternate;
        }
        
        .task-requester-avatar.high-priority {
            width: 36px;
            height: 36px;
            border-color: #dc3545;
            box-shadow: 0 0 8px rgba(220, 53, 69, 0.2);
        }
        
        .task-requester-avatar.medium-priority {
            width: 30px;
            height: 30px;
            border-color: #ffc107;
            box-shadow: 0 0 4px rgba(255, 193, 7, 0.1);
        }
        
        .task-requester-avatar.low-priority {
            width: 24px;
            height: 24px;
            border-color: #28a745;
        }
        
        /* ‰ø°È†º„Éù„Ç§„É≥„Éà„Ç∑„Çπ„ÉÜ„É† */
        .trust-points-container {
            position: relative;
            display: inline-block;
        }
        
        .trust-points {
            position: absolute;
            top: -10px;
            right: -10px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.4);
            animation: trustPointGlow 2s ease-in-out infinite alternate;
            z-index: 10;
        }
        
        .trust-points.high {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            box-shadow: 0 2px 12px rgba(255, 107, 107, 0.6);
            animation: trustPointGlow 1s ease-in-out infinite alternate;
        }
        
        .trust-points.medium {
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
            box-shadow: 0 2px 10px rgba(78, 205, 196, 0.5);
        }
        
        .trust-points.low {
            background: linear-gradient(45deg, #A8E6CF, #7FCDCD);
            box-shadow: 0 2px 6px rgba(168, 230, 207, 0.3);
        }
        
        @keyframes trustPointGlow {
            from { 
                transform: scale(1);
                box-shadow: 0 2px 8px rgba(255, 215, 0, 0.4);
            }
            to { 
                transform: scale(1.1);
                box-shadow: 0 4px 16px rgba(255, 215, 0, 0.8);
            }
        }
        
        /* ‰ø°È†º„Éù„Ç§„É≥„Éà„ÅÆËªåÈÅì„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .trust-point-trail {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
            animation: trustPointTrail 1s ease-out forwards;
            z-index: 5;
        }
        
        @keyframes trustPointTrail {
            0% {
                opacity: 1;
                transform: scale(0.5);
            }
            100% {
                opacity: 0;
                transform: scale(1.5) translateY(-20px);
            }
        }
        
        /* ‰ø°È†º„É¨„Éô„É´Ë°®Á§∫ */
        .trust-level-display {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            white-space: nowrap;
            z-index: 15;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .trust-level-display.show {
            opacity: 1;
        }
        
        .trust-level-display.high {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
        }
        
        .trust-level-display.medium {
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
        }
        
        .trust-level-display.low {
            background: linear-gradient(45deg, #A8E6CF, #7FCDCD);
            color: #333;
        }

        /* ‰æùÈ†ºËÄÖÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É† */
        .requester-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .requester-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            padding: 20px 0;
        }

        .requester-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .requester-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            border-color: #007AFF;
        }

        .requester-card.current {
            border-color: #007AFF;
            background: linear-gradient(135deg, #f0f8ff, #e6f3ff);
        }

        .requester-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .requester-card-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #e0e0e0;
        }

        .requester-card-info h4 {
            margin: 0 0 5px 0;
            font-size: 18px;
            color: #333;
        }

        .requester-card-info p {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        .requester-card-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #007AFF;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        .requester-card-actions {
            display: flex;
            gap: 10px;
        }

        .requester-card-actions button {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .requester-card-actions .select-btn {
            background: #007AFF;
            color: white;
        }

        .requester-card-actions .select-btn:hover {
            background: #0056CC;
        }

        .requester-card-actions .detail-btn {
            background: #f0f0f0;
            color: #333;
        }

        .requester-card-actions .detail-btn:hover {
            background: #e0e0e0;
        }

        /* ‰æùÈ†ºËÄÖË©≥Á¥∞„Éö„Éº„Ç∏ */
        .page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f5f5f5;
            z-index: 1000;
            overflow-y: auto;
        }

        .page-header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 15px;
            position: sticky;
            top: 0;
            z-index: 1001;
        }

        .back-button {
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: #e0e0e0;
        }

        .page-content {
            padding: 20px;
        }

        .requester-detail-info {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .requester-detail-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .requester-detail-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #e0e0e0;
        }

        .requester-detail-info h3 {
            margin: 0 0 10px 0;
            font-size: 24px;
            color: #333;
        }

        .requester-detail-info p {
            margin: 5px 0;
            color: #666;
        }

        .requester-stats {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-card {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-card .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #007AFF;
            margin-bottom: 5px;
        }

        .stat-card .stat-label {
            font-size: 14px;
            color: #666;
        }

        .requester-tasks {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* „É¢„Éº„ÉÄ„É´„Çπ„Çø„Ç§„É´„ÅÆÊã°Âºµ */
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 20px;
            color: #333;
        }

        .close-button {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-button:hover {
            color: #333;
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .form-group .input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-group .input:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">„Ç¢„Éâ„Éè„Éâ„É©„Ç§„Éñ</h1>
        <p class="subtitle">ÂçîÂÉçÂûãADHDÂêë„Åë„Çø„Çπ„ÇØÁÆ°ÁêÜ</p>
        
        <div class="trust-container">
            <div class="trust-label">‰ø°È†ºÂ∫¶: <span id="trustLevel">85</span>%</div>
            <div class="trust-bar">
                <div class="trust-progress" id="trustProgress" style="width: 85%"></div>
            </div>
        </div>
        
        <div class="invite-section">
            <div class="invite-title">üë• Áõ£Ë¶ñËÄÖ„ÇíÊãõÂæÖ</div>
            <input type="email" class="invite-input" id="inviteEmail" placeholder="„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÇíÂÖ•Âäõ">
            <button class="invite-button" onclick="inviteUser()">ÊãõÂæÖ„Åô„Çã</button>
            <div class="invited-users" id="invitedUsers">
                <!-- ÊãõÂæÖ„Åï„Çå„Åü„É¶„Éº„Ç∂„Éº„ÅåË°®Á§∫„Åï„Çå„Çã -->
            </div>
        </div>
        
        <div class="invite-section">
            <div class="invite-title">üë§ ‰æùÈ†ºËÄÖÁÆ°ÁêÜ</div>
            <div class="requester-controls">
                <button onclick="showAddRequesterForm()" class="invite-button">Êñ∞„Åó„ÅÑ‰æùÈ†ºËÄÖ„ÇíËøΩÂä†</button>
            </div>
            <div class="requester-info" id="requesterInfo">
                <!-- ÁèæÂú®„ÅÆ‰æùÈ†ºËÄÖÊÉÖÂ†±„ÅåË°®Á§∫„Åï„Çå„Çã -->
            </div>
        </div>

        <!-- ‰æùÈ†ºËÄÖ‰∏ÄË¶ß„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div class="section">
            <h3>‰æùÈ†ºËÄÖ‰∏ÄË¶ß</h3>
            <div id="requesterList" class="requester-list">
                <!-- ‰æùÈ†ºËÄÖ‰∏ÄË¶ß„ÅåË°®Á§∫„Åï„Çå„Çã -->
            </div>
        </div>
        
        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <button class="record-button" onclick="startEmergencyMode()" style="flex: 1; background-color: #FF3B30;">Á∑äÊÄ•„É¢„Éº„ÉâÈñãÂßã</button>
            <button class="record-button" onclick="showAddTaskModal()" style="flex: 1; background-color: #28a745;">ÈÄöÂ∏∏„Çø„Çπ„ÇØËøΩÂä†</button>
        </div>
        
        <div class="tasks-container">
            <div class="tasks-title">üìã „Çø„Çπ„ÇØ‰∏ÄË¶ß</div>
            <div id="taskList">
                <!-- „Çø„Çπ„ÇØ„ÅåË°®Á§∫„Åï„Çå„Çã -->
            </div>
        </div>
        
        <div class="stats-container">
            <div class="stats-title">ÂÖàËº©„Åã„Çâ„ÅÆ‰ø°È†ºÂ∫¶: <span id="statsTrustLevel">85</span>%</div>
            <div class="stats-subtitle">„ÉÅ„Éº„É†„Å∏„ÅÆÂΩ±ÈüøÂ∫¶: <span id="teamImpact">95</span>%</div>
        </div>
    </div>
    
    <!-- Á∑äÊÄ•„É¢„Éº„ÉâÁîªÈù¢ -->
    <div class="emergency-container" id="emergencyContainer">
        <div class="warning-container" id="warningContainer">
            <div class="warning-icon">‚ö†Ô∏è</div>
            <div class="warning-title">Á∑äÊÄ•„Çø„Çπ„ÇØÁô∫ÁîüÔºÅ</div>
            <div class="warning-subtitle">ÂÖàËº©„ÅåË©±„Åó„Å¶„ÅÑ„Åæ„Åô</div>
        </div>
        
        <button class="emergency-button" onclick="startRecording()">‰ªä„Åô„ÅêË®òÈå≤</button>
        
        <div class="countdown-container">
            <div class="countdown-label">ÊÆã„ÇäÊôÇÈñì: <span id="countdown">5.0</span>Áßí</div>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
        </div>
        
        <div class="warning-list">
            <div class="warning-item">‚Ä¢ ÂÖàËº©„Å´ÊÄí„Çâ„Çå„Çã</div>
            <div class="warning-item">‚Ä¢ ‰ø°È†ºÂ∫¶„Åå‰∏ã„Åå„Çã</div>
            <div class="warning-item">‚Ä¢ „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈÅÖÂª∂</div>
        </div>
    </div>
    
    <!-- Ë®òÈå≤‰∏≠ÁîªÈù¢ -->
    <div class="recording-container" id="recordingContainer">
        <div class="recording-icon">üé§</div>
        <div class="recording-title">Ë®òÈå≤‰∏≠...</div>
        <div class="recording-subtitle">Èü≥Â£∞„ÇíÈå≤Èü≥„Åó„Å¶„ÅÑ„Åæ„Åô</div>
        
        <button class="stop-button" onclick="stopRecording()">ÂÅúÊ≠¢</button>
        
        <div class="trust-container">
            <div class="trust-label">‰ø°È†ºÂ∫¶: <span id="recordingTrustLevel">85</span>%</div>
            <div class="trust-bar">
                <div class="trust-progress" id="recordingTrustProgress" style="width: 85%"></div>
            </div>
        </div>
    </div>
    
    <!-- ÈÄöÁü• -->
    <div class="notification" id="notification">
        <div id="notificationText"></div>
    </div>


    <!-- ‰æùÈ†ºËÄÖËøΩÂä†„É¢„Éº„ÉÄ„É´ -->
    <div id="addRequesterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Êñ∞„Åó„ÅÑ‰æùÈ†ºËÄÖ„ÇíËøΩÂä†</h3>
                <button onclick="hideAddRequesterForm()" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newRequesterName">‰æùÈ†ºËÄÖÂêç</label>
                    <input type="text" id="newRequesterName" placeholder="‰æùÈ†ºËÄÖÂêç" class="input">
                </div>
                <div class="form-group">
                    <label for="newRequesterAvatar">„Ç¢„Ç§„Ç≥„É≥URL</label>
                    <input type="url" id="newRequesterAvatar" placeholder="„Ç¢„Ç§„Ç≥„É≥URL" class="input">
                </div>
                <div class="form-group">
                    <label for="newRequesterEmail">„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ</label>
                    <input type="email" id="newRequesterEmail" placeholder="„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ" class="input">
                </div>
                <div class="form-group">
                    <label for="newRequesterDepartment">ÈÉ®ÁΩ≤„ÉªÂΩπËÅ∑</label>
                    <input type="text" id="newRequesterDepartment" placeholder="ÈÉ®ÁΩ≤„ÉªÂΩπËÅ∑" class="input">
                </div>
                <button onclick="addRequester()" class="button">‰æùÈ†ºËÄÖ„ÇíËøΩÂä†</button>
            </div>
        </div>
    </div>

    <!-- ‰æùÈ†ºËÄÖË©≥Á¥∞„Éö„Éº„Ç∏ -->
    <div id="requesterDetailPage" class="page" style="display: none;">
        <div class="page-header">
            <button onclick="hideRequesterDetail()" class="back-button">‚Üê Êàª„Çã</button>
            <h2 id="requesterDetailName">‰æùÈ†ºËÄÖË©≥Á¥∞</h2>
        </div>
        <div class="page-content">
            <div id="requesterDetailInfo" class="requester-detail-info"></div>
            <div class="requester-stats">
                <h3>Áµ±Ë®àÊÉÖÂ†±</h3>
                <div id="requesterStats" class="stats-grid"></div>
            </div>
            <div class="requester-tasks">
                <h3>Èñ¢ÈÄ£„Çø„Çπ„ÇØ</h3>
                <div id="requesterTasks" class="task-list"></div>
            </div>
        </div>
    </div>
    
    <!-- „Çø„Çπ„ÇØËøΩÂä†„É¢„Éº„ÉÄ„É´ -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <h2 class="modal-title">üìù Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„ÇíËøΩÂä†</h2>
            
            <div class="form-group">
                <label class="form-label" for="taskTitle">„Çø„Çπ„ÇØ„Çø„Ç§„Éà„É´</label>
                <input type="text" class="form-input" id="taskTitle" placeholder="‰æã: Êù•ÈÄ±„Åæ„Åß„Å´Ë≥áÊñô„Åæ„Å®„ÇÅ">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="taskDescription">Ë©≥Á¥∞Ë™¨ÊòéÔºà‰ªªÊÑèÔºâ</label>
                <textarea class="form-textarea" id="taskDescription" placeholder="„Çø„Çπ„ÇØ„ÅÆË©≥Á¥∞„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ..."></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">ÂÑ™ÂÖàÂ∫¶</label>
                <div class="priority-selector">
                    <div class="priority-option low" data-priority="low" onclick="selectPriority('low')">
                        <div style="font-weight: bold;">‰Ωé</div>
                        <div style="font-size: 12px;">‰ΩôË£ï„Åå„ÅÇ„Çã</div>
                    </div>
                    <div class="priority-option medium selected" data-priority="medium" onclick="selectPriority('medium')">
                        <div style="font-weight: bold;">‰∏≠</div>
                        <div style="font-size: 12px;">ÊôÆÈÄö</div>
                    </div>
                    <div class="priority-option high" data-priority="high" onclick="selectPriority('high')">
                        <div style="font-weight: bold;">È´ò</div>
                        <div style="font-size: 12px;">ÊÄ•„Åé</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="taskDeadline">ÊúüÈôêÔºà‰ªªÊÑèÔºâ</label>
                <input type="datetime-local" class="form-input" id="taskDeadline">
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="hideAddTaskModal()">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn btn-primary" onclick="addTask()">„Çø„Çπ„ÇØ„ÇíËøΩÂä†</button>
            </div>
        </div>
    </div>

    <script>
        // Áä∂ÊÖãÁÆ°ÁêÜ
        let trustLevel = 85;
        let isEmergencyMode = false;
        let isRecording = false;
        let countdown = 5;
        let countdownInterval = null;
        let recording = null;
        let tasks = [];
        let invitedUsers = [];
        let taskIdCounter = 0;
        let selectedPriority = 'medium';
        let requester = null;
        let requesterTrustPoints = 0;
        let requesterTrustLevel = 'low';
        let requesters = [];
        let currentRequesterId = null;

        // „Çø„Çπ„ÇØ„ÅÆÁä∂ÊÖã
        const TASK_STATUS = {
            PENDING: 'pending',
            IN_PROGRESS: 'in-progress',
            COMPLETED: 'completed'
        };

        // „É¶„Éº„Ç∂„Éº„ÅÆÁä∂ÊÖã
        const USER_STATUS = {
            WATCHING: 'watching',
            NOTIFIED: 'notified'
        };

        // ‰ø°È†ºÂ∫¶„ÅÆÊõ¥Êñ∞
        function updateTrustLevel(change) {
            trustLevel = Math.max(0, Math.min(100, trustLevel + change));
            updateTrustDisplay();
            localStorage.setItem('trustLevel', trustLevel.toString());
        }

        // ‰ø°È†ºÂ∫¶Ë°®Á§∫„ÅÆÊõ¥Êñ∞
        function updateTrustDisplay() {
            document.getElementById('trustLevel').textContent = trustLevel;
            document.getElementById('statsTrustLevel').textContent = trustLevel;
            document.getElementById('recordingTrustLevel').textContent = trustLevel;
            document.getElementById('teamImpact').textContent = Math.min(100, trustLevel + 10);
            
            const progressBars = document.querySelectorAll('.trust-progress');
            progressBars.forEach(bar => {
                bar.style.width = trustLevel + '%';
            });
        }

        // „É¶„Éº„Ç∂„Éº„ÇíÊãõÂæÖ
        function inviteUser() {
            const email = document.getElementById('inviteEmail').value.trim();
            if (!email) {
                alert('„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            if (invitedUsers.some(user => user.email === email)) {
                alert('Êó¢„Å´ÊãõÂæÖÊ∏à„Åø„Åß„Åô');
                return;
            }
            
            const user = {
                id: Date.now(),
                email: email,
                status: USER_STATUS.WATCHING,
                invitedAt: new Date()
            };
            
            invitedUsers.push(user);
            document.getElementById('inviteEmail').value = '';
            updateInvitedUsersDisplay();
            
            showNotification(`${email} „ÇíÊãõÂæÖ„Åó„Åæ„Åó„Åü`);
        }

        // ÊãõÂæÖ„É¶„Éº„Ç∂„ÉºË°®Á§∫„ÅÆÊõ¥Êñ∞
        function updateInvitedUsersDisplay() {
            const container = document.getElementById('invitedUsers');
            container.innerHTML = invitedUsers.map(user => `
                <div class="user-item">
                    <span>${user.email}</span>
                    <span class="user-status status-${user.status}">
                        ${user.status === USER_STATUS.WATCHING ? 'Áõ£Ë¶ñ‰∏≠' : 'ÈÄöÁü•Ê∏à„Åø'}
                    </span>
                </div>
            `).join('');
        }

        // „Çø„Çπ„ÇØ„ÇíÈñãÂßã
        function startTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.status = TASK_STATUS.IN_PROGRESS;
                task.startedAt = new Date();
                updateTaskList();
                
                // Áõ£Ë¶ñËÄÖ„Å´ÈÄöÁü•
                notifyWatchers(`„Çø„Çπ„ÇØ„Äå${task.content}„Äç„ÇíÈñãÂßã„Åó„Åæ„Åó„Åü`, task);
                
                showNotification('„Çø„Çπ„ÇØ„ÇíÈñãÂßã„Åó„Åæ„Åó„ÅüÔºÅÁõ£Ë¶ñËÄÖ„Å´ÈÄöÁü•„Åó„Åæ„Åó„Åü');
            }
        }

        // „Çø„Çπ„ÇØ„ÇíÂÆå‰∫Ü
        function completeTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.status = TASK_STATUS.COMPLETED;
                task.completedAt = new Date();
                updateTaskList();
                
                // ‰ø°È†ºÂ∫¶‰∏äÊòá
                updateTrustLevel(10);
                
                // ‰ø°È†º„Éù„Ç§„É≥„Éà„ÇíË®àÁÆó„Åó„Å¶ËøΩÂä†
                if (task.requester) {
                    const trustPoints = calculateTrustPoints(task);
                    addTrustPoints(trustPoints);
                    
                    // ‰æùÈ†ºËÄÖ‰∏ÄË¶ß„ÅÆ‰ø°È†º„Éù„Ç§„É≥„Éà„ÇÇÊõ¥Êñ∞
                    const requesterInList = requesters.find(req => req.name === task.requester.name);
                    if (requesterInList) {
                        requesterInList.trustPoints += trustPoints;
                        requesterInList.completedTasks += 1;
                        requesterInList.totalTasks += 1;
                        
                        // ‰ø°È†º„É¨„Éô„É´„ÇíÊõ¥Êñ∞
                        if (requesterInList.trustPoints >= 200) {
                            requesterInList.trustLevel = 'high';
                        } else if (requesterInList.trustPoints >= 100) {
                            requesterInList.trustLevel = 'medium';
                        } else {
                            requesterInList.trustLevel = 'low';
                        }
                    }
                    
                    // ‰ø°È†º„Éù„Ç§„É≥„ÉàÁç≤Âæó„ÅÆÈÄöÁü•
                    showNotification(`‰ø°È†º„Éù„Ç§„É≥„Éà +${trustPoints} Áç≤ÂæóÔºÅ`);
                }
                
                // Áõ£Ë¶ñËÄÖ„Å´ÈÄöÁü•
                notifyWatchers(`„Çø„Çπ„ÇØ„Äå${task.content}„Äç„ÇíÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ`, task);
                
                showNotification('„Çø„Çπ„ÇØÂÆå‰∫ÜÔºÅ‰ø°È†ºÂ∫¶„Åå‰∏äÊòá„Åó„Åæ„Åó„Åü');
            }
        }

        // Áõ£Ë¶ñËÄÖ„Å´ÈÄöÁü•
        function notifyWatchers(message, task) {
            invitedUsers.forEach(user => {
                if (user.status === USER_STATUS.WATCHING) {
                    user.status = USER_STATUS.NOTIFIED;
                    // ÂÆüÈöõ„ÅÆ„Ç¢„Éó„É™„Åß„ÅØ„ÄÅ„Åì„Åì„Åß„É°„Éº„É´„ÇÑ„Éó„ÉÉ„Ç∑„É•ÈÄöÁü•„ÇíÈÄÅ‰ø°
                    console.log(`ÈÄöÁü•: ${user.email} - ${message}`);
                }
            });
            updateInvitedUsersDisplay();
        }

        // „Çø„Çπ„ÇØ„É™„Çπ„Éà„ÅÆÊõ¥Êñ∞
        function updateTaskList() {
            const taskList = document.getElementById('taskList');
            if (tasks.length === 0) {
                taskList.innerHTML = '<div class="task-item">„Çø„Çπ„ÇØ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                return;
            }
            
            taskList.innerHTML = tasks.map(task => {
                const priorityIcon = task.priority === 'high' ? 'üî¥' : task.priority === 'medium' ? 'üü°' : 'üü¢';
                const deadlineText = task.deadline ? ` (ÊúüÈôê: ${new Date(task.deadline).toLocaleDateString()})` : '';
                const typeIcon = task.type === 'manual' ? 'üìù' : 'üé§';
                
                // ‰æùÈ†ºËÄÖ„Ç¢„Ç§„Ç≥„É≥„ÅÆË°®Á§∫ÔºàÂãïÁöÑÁ∑äÊÄ•Â∫¶ÂØæÂøúÔºâ
                const urgency = calculateUrgencyLevel(task);
                const urgencyClass = getUrgencySizeClass(urgency);
                const requesterHtml = task.requester ? `
                    <div class="task-requester">
                        <img src="${task.requester.avatar}" alt="${task.requester.name}" 
                             class="task-requester-avatar ${urgencyClass}">
                        <span class="task-requester-name">${task.requester.name}</span>
                        <span style="font-size: 10px; color: #999; margin-left: 5px;">
                            ${task.deadline ? `(${Math.round(urgency * 100)}%Á∑äÊÄ•)` : ''}
                        </span>
                    </div>
                ` : '';
                
                return `
                    <div class="task-item">
                        <div class="task-content">
                            ${requesterHtml}
                            <div style="display: flex; align-items: center; gap: 5px;">
                                ${typeIcon} ${priorityIcon} ${task.content}${deadlineText}
                                ${task.deadline ? `<span style="font-size: 10px; color: #FF3B30; font-weight: bold;">
                                    ${urgency >= 1.0 ? 'üö®' : urgency >= 0.7 ? '‚ö†Ô∏è' : ''}
                                </span>` : ''}
                            </div>
                            ${task.description ? `<div style="font-size: 12px; color: #666; margin-top: 4px;">${task.description}</div>` : ''}
                            <span class="task-status status-${task.status}">
                                ${task.status === TASK_STATUS.PENDING ? 'ÂæÖÊ©ü‰∏≠' : 
                                  task.status === TASK_STATUS.IN_PROGRESS ? 'ÂÆüË°å‰∏≠' : 'ÂÆå‰∫Ü'}
                            </span>
                        </div>
                        <div class="task-actions">
                            ${task.status === TASK_STATUS.PENDING ? 
                                `<button class="task-button start-button" onclick="startTask(${task.id})">ÈñãÂßã</button>` : ''}
                            ${task.status === TASK_STATUS.IN_PROGRESS ? 
                                `<button class="task-button complete-button" onclick="completeTask(${task.id})">ÂÆå‰∫Ü</button>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            // ‰æùÈ†ºËÄÖ„Ç¢„Ç§„Ç≥„É≥„ÅÆ„Çµ„Ç§„Ç∫„ÇíÊõ¥Êñ∞
            updateRequesterAvatarSizes();
        }

        // ÂÑ™ÂÖàÂ∫¶„Å´Âøú„Åò„ÅüCSS„ÇØ„É©„Çπ„ÇíÂèñÂæó
        function getPriorityClass(priority) {
            switch(priority) {
                case 'high': return 'high-priority';
                case 'medium': return 'medium-priority';
                case 'low': return 'low-priority';
                default: return 'medium-priority';
            }
        }

        // ‰æùÈ†ºËÄÖ„Ç¢„Ç§„Ç≥„É≥„ÅÆ„Çµ„Ç§„Ç∫„ÇíÊõ¥Êñ∞
        function updateRequesterAvatarSizes() {
            const requesterAvatar = document.getElementById('requesterAvatarImg');
            if (requesterAvatar && requester) {
                // ÊúÄÈ´òÁ∑äÊÄ•Â∫¶„Å´Âü∫„Å•„ÅÑ„Å¶„Çµ„Ç§„Ç∫„ÇíÊ±∫ÂÆö
                const highestUrgency = getHighestUrgencyLevel();
                const urgencyClass = getUrgencySizeClass(highestUrgency);
                requesterAvatar.className = `requester-avatar ${urgencyClass}`;
            }
        }

        // ÊúÄÈ´òÂÑ™ÂÖàÂ∫¶„ÅÆ„Çø„Çπ„ÇØ„ÅÆÂÑ™ÂÖàÂ∫¶„ÇíÂèñÂæó
        function getHighestTaskPriority() {
            if (tasks.length === 0) return 'medium';
            
            const priorities = tasks.map(task => task.priority);
            if (priorities.includes('high')) return 'high';
            if (priorities.includes('medium')) return 'medium';
            return 'low';
        }

        // ÊúüÈôê„Å´Âü∫„Å•„ÅèÁ∑äÊÄ•Â∫¶„ÇíË®àÁÆó
        function calculateUrgencyLevel(task) {
            if (!task.deadline) {
                // ÊúüÈôê„Åå„Å™„ÅÑÂ†¥Âêà„ÅØÂÑ™ÂÖàÂ∫¶„ÅÆ„Åø„ÅßÂà§Êñ≠
                return task.priority === 'high' ? 0.8 : task.priority === 'medium' ? 0.5 : 0.2;
            }
            
            const now = new Date();
            const deadline = new Date(task.deadline);
            const timeDiff = deadline.getTime() - now.getTime();
            const hoursLeft = timeDiff / (1000 * 60 * 60);
            
            // ÊúüÈôê„Åæ„Åß„ÅÆÊôÇÈñì„Å´Âü∫„Å•„ÅèÁ∑äÊÄ•Â∫¶Ë®àÁÆó
            let urgency = 1.0; // ÊúÄÂ§ßÁ∑äÊÄ•Â∫¶
            
            if (hoursLeft > 24 * 7) { // 1ÈÄ±Èñì‰ª•‰∏ä
                urgency = 0.3;
            } else if (hoursLeft > 24 * 3) { // 3Êó•‰ª•‰∏ä
                urgency = 0.5;
            } else if (hoursLeft > 24) { // 1Êó•‰ª•‰∏ä
                urgency = 0.7;
            } else if (hoursLeft > 6) { // 6ÊôÇÈñì‰ª•‰∏ä
                urgency = 0.9;
            } else if (hoursLeft > 0) { // ÊúüÈôêÂâç
                urgency = 1.0;
            } else { // ÊúüÈôêË∂ÖÈÅé
                urgency = 1.2; // ÊúÄÂ§ßÁ∑äÊÄ•Â∫¶ + ÊúüÈôêË∂ÖÈÅé
            }
            
            // ÂÑ™ÂÖàÂ∫¶„Å´„Çà„ÇãË™øÊï¥
            const priorityMultiplier = task.priority === 'high' ? 1.0 : task.priority === 'medium' ? 0.8 : 0.6;
            
            return Math.min(1.2, urgency * priorityMultiplier);
        }

        // ÊúÄÈ´òÁ∑äÊÄ•Â∫¶„ÇíÂèñÂæó
        function getHighestUrgencyLevel() {
            if (tasks.length === 0) return 0.5;
            
            const urgencies = tasks.map(task => calculateUrgencyLevel(task));
            return Math.max(...urgencies);
        }

        // Á∑äÊÄ•Â∫¶„Å´Âü∫„Å•„Åè„Çµ„Ç§„Ç∫„ÇØ„É©„Çπ„ÇíÂèñÂæó
        function getUrgencySizeClass(urgency) {
            if (urgency >= 1.1) return 'urgent'; // ÊúüÈôêË∂ÖÈÅé
            if (urgency >= 0.9) return 'very-high'; // 6ÊôÇÈñì‰ª•ÂÜÖ
            if (urgency >= 0.7) return 'high-priority'; // 1Êó•‰ª•ÂÜÖ
            if (urgency >= 0.5) return 'medium-priority'; // 3Êó•‰ª•ÂÜÖ
            return 'low-priority'; // 1ÈÄ±Èñì‰ª•‰∏ä
        }

        // ‰ø°È†º„Éù„Ç§„É≥„Éà„ÇíË®àÁÆó
        function calculateTrustPoints(task) {
            if (!task.completedAt || !task.startedAt) return 0;
            
            const startTime = new Date(task.startedAt);
            const completeTime = new Date(task.completedAt);
            const duration = completeTime.getTime() - startTime.getTime();
            const hours = duration / (1000 * 60 * 60);
            
            // ÊúüÈôê„Åæ„Åß„ÅÆÊôÇÈñì„ÇíË®àÁÆó
            let deadlineBonus = 0;
            if (task.deadline) {
                const deadline = new Date(task.deadline);
                const timeLeft = deadline.getTime() - completeTime.getTime();
                const hoursLeft = timeLeft / (1000 * 60 * 60);
                
                if (hoursLeft > 0) {
                    // ÊúüÈôêÂâç„Å´ÂÆå‰∫Ü„Åó„ÅüÂ†¥Âêà„ÅÆ„Éú„Éº„Éä„Çπ
                    deadlineBonus = Math.min(50, hoursLeft * 2);
                }
            }
            
            // Âü∫Êú¨„Éù„Ç§„É≥„ÉàÔºàÂÆå‰∫Ü„Åó„Åü„ÇâÂøÖ„Åö„ÇÇ„Çâ„Åà„ÇãÔºâ
            let basePoints = 10;
            
            // ÂÑ™ÂÖàÂ∫¶„Éú„Éº„Éä„Çπ
            const priorityBonus = task.priority === 'high' ? 20 : task.priority === 'medium' ? 10 : 5;
            
            // ÈÄüÂ∫¶„Éú„Éº„Éä„ÇπÔºàÊó©„ÅèÂÆå‰∫Ü„Åô„Çã„Åª„Å©È´ò„Éù„Ç§„É≥„ÉàÔºâ
            let speedBonus = 0;
            if (hours < 1) speedBonus = 30; // 1ÊôÇÈñì‰ª•ÂÜÖ
            else if (hours < 4) speedBonus = 20; // 4ÊôÇÈñì‰ª•ÂÜÖ
            else if (hours < 24) speedBonus = 10; // 1Êó•‰ª•ÂÜÖ
            else speedBonus = 0; // 1Êó•‰ª•‰∏ä
            
            // Á∑äÊÄ•Â∫¶„Éú„Éº„Éä„Çπ
            const urgency = calculateUrgencyLevel(task);
            const urgencyBonus = Math.round(urgency * 20);
            
            return Math.round(basePoints + priorityBonus + speedBonus + deadlineBonus + urgencyBonus);
        }

        // ‰ø°È†º„É¨„Éô„É´„ÇíÊõ¥Êñ∞
        function updateTrustLevel() {
            if (requesterTrustPoints >= 200) {
                requesterTrustLevel = 'high';
            } else if (requesterTrustPoints >= 100) {
                requesterTrustLevel = 'medium';
            } else {
                requesterTrustLevel = 'low';
            }
        }

        // ‰ø°È†º„Éù„Ç§„É≥„Éà„ÇíËøΩÂä†
        function addTrustPoints(points) {
            requesterTrustPoints += points;
            updateTrustLevel();
            
            // ‰ø°È†º„Éù„Ç§„É≥„Éà„ÅÆËªåÈÅì„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            createTrustPointTrail(points);
            
            // ‰ø°È†º„É¨„Éô„É´Ë°®Á§∫„ÇíÊõ¥Êñ∞
            updateRequesterDisplay();
        }

        // ‰ø°È†º„Éù„Ç§„É≥„Éà„ÅÆËªåÈÅì„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Çí‰ΩúÊàê
        function createTrustPointTrail(points) {
            const container = document.querySelector('.requester-item');
            if (!container) return;
            
            const trail = document.createElement('div');
            trail.className = 'trust-point-trail';
            trail.textContent = `+${points}`;
            trail.style.position = 'absolute';
            trail.style.top = '50%';
            trail.style.left = '50%';
            trail.style.transform = 'translate(-50%, -50%)';
            trail.style.fontSize = '10px';
            trail.style.fontWeight = 'bold';
            trail.style.color = '#FFD700';
            trail.style.zIndex = '20';
            
            container.appendChild(trail);
            
            setTimeout(() => {
                if (trail.parentNode) {
                    trail.parentNode.removeChild(trail);
                }
            }, 1000);
        }

        // Á∑äÊÄ•„É¢„Éº„Éâ„ÅÆÈñãÂßã
        function startEmergencyMode() {
            isEmergencyMode = true;
            countdown = 5;
            document.getElementById('emergencyContainer').style.display = 'flex';
            document.getElementById('warningContainer').classList.add('pulse', 'shake');
            
            // ÊåØÂãïÔºàÂØæÂøú„Éñ„É©„Ç¶„Ç∂„ÅÆ„ÅøÔºâ
            if (navigator.vibrate) {
                navigator.vibrate([0, 500, 200, 500]);
            }
            
            // „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ÈñãÂßã
            countdownInterval = setInterval(() => {
                countdown -= 0.1;
                document.getElementById('countdown').textContent = countdown.toFixed(1);
                document.getElementById('progress').style.width = (countdown / 5) * 100 + '%';
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    isEmergencyMode = false;
                    document.getElementById('emergencyContainer').style.display = 'none';
                    alert('Ë®òÈå≤„Åó„Åæ„Åõ„Çì„Åß„Åó„Åü\n‰ø°È†ºÂ∫¶„Åå‰∏ã„Åå„Çä„Åæ„Åó„Åü...');
                    updateTrustLevel(-5);
                }
            }, 100);
        }

        // Èå≤Èü≥ÈñãÂßã
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                recording = new MediaRecorder(stream);
                
                isRecording = true;
                isEmergencyMode = false;
                document.getElementById('emergencyContainer').style.display = 'none';
                document.getElementById('recordingContainer').style.display = 'flex';
                
                // ‰ø°È†ºÂ∫¶‰∏äÊòá
                updateTrustLevel(5);
                
                alert('Ë®òÈå≤ÈñãÂßã\nÈü≥Â£∞„ÇíÈå≤Èü≥„Åó„Å¶„ÅÑ„Åæ„Åô...');
            } catch (error) {
                alert('„Ç®„É©„Éº\nÈå≤Èü≥„ÅÆÈñãÂßã„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
            }
        }

        // Èå≤Èü≥ÂÅúÊ≠¢
        function stopRecording() {
            if (recording) {
                recording.stop();
                recording = null;
            }
            
            isRecording = false;
            document.getElementById('recordingContainer').style.display = 'none';
            
            // Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„ÇíËøΩÂä†
            const newTask = {
                id: ++taskIdCounter,
                content: `Èå≤Èü≥„Çø„Çπ„ÇØ ${new Date().toLocaleTimeString()}`,
                status: TASK_STATUS.PENDING,
                createdAt: new Date()
            };
            tasks.unshift(newTask);
            tasks = tasks.slice(0, 10); // ÊúÄÊñ∞10‰ª∂„Çí‰øùÊåÅ
            
            updateTaskList();
            
            // Áõ£Ë¶ñËÄÖ„Å´ÈÄöÁü•
            notifyWatchers(`Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„Äå${newTask.content}„Äç„ÅåËøΩÂä†„Åï„Çå„Åæ„Åó„Åü`, newTask);
            
            alert('Ë®òÈå≤ÂÆå‰∫Ü\n„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅÂÖàËº©„Å´‰ø°È†º„Åï„Çå„Å¶„ÅÑ„Åæ„Åô');
        }

        // ÈÄöÁü•„ÇíË°®Á§∫
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            notificationText.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // „Çø„Çπ„ÇØËøΩÂä†„É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫
        function showAddTaskModal() {
            document.getElementById('addTaskModal').style.display = 'flex';
            // „Éï„Ç©„Éº„É†„Çí„É™„Çª„ÉÉ„Éà
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDescription').value = '';
            document.getElementById('taskDeadline').value = '';
            selectPriority('medium');
        }

        // „Çø„Çπ„ÇØËøΩÂä†„É¢„Éº„ÉÄ„É´„ÇíÈùûË°®Á§∫
        function hideAddTaskModal() {
            document.getElementById('addTaskModal').style.display = 'none';
        }

        // ÂÑ™ÂÖàÂ∫¶„ÇíÈÅ∏Êäû
        function selectPriority(priority) {
            selectedPriority = priority;
            document.querySelectorAll('.priority-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`[data-priority="${priority}"]`).classList.add('selected');
        }

        // ‰æùÈ†ºËÄÖ„ÇíË®≠ÂÆö
        function setRequester() {
            const name = document.getElementById('requesterName').value.trim();
            const avatarUrl = document.getElementById('requesterAvatar').value.trim();

            if (!name) {
                alert('‰æùÈ†ºËÄÖÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            requester = {
                name: name,
                avatar: avatarUrl || 'https://via.placeholder.com/40x40/007AFF/FFFFFF?text=' + encodeURIComponent(name.charAt(0)),
                setAt: new Date()
            };

            document.getElementById('requesterName').value = '';
            document.getElementById('requesterAvatar').value = '';
            updateRequesterDisplay();

            showNotification(`${name} „Çí‰æùÈ†ºËÄÖ„Å´Ë®≠ÂÆö„Åó„Åæ„Åó„Åü`);
        }

        // ‰æùÈ†ºËÄÖ‰∏ÄË¶ß„ÇíË°®Á§∫Ôºà„É°„Ç§„É≥„Éö„Éº„Ç∏„Å´Áõ¥Êé•Ë°®Á§∫Ôºâ
        function showRequesterList() {
            updateRequesterList();
        }

        // ‰æùÈ†ºËÄÖËøΩÂä†„Éï„Ç©„Éº„É†„ÇíË°®Á§∫
        function showAddRequesterForm() {
            document.getElementById('addRequesterModal').style.display = 'block';
        }

        // ‰æùÈ†ºËÄÖËøΩÂä†„Éï„Ç©„Éº„É†„ÇíÈùûË°®Á§∫
        function hideAddRequesterForm() {
            document.getElementById('addRequesterModal').style.display = 'none';
            // „Éï„Ç©„Éº„É†„Çí„É™„Çª„ÉÉ„Éà
            document.getElementById('newRequesterName').value = '';
            document.getElementById('newRequesterAvatar').value = '';
            document.getElementById('newRequesterEmail').value = '';
            document.getElementById('newRequesterDepartment').value = '';
        }

        // Êñ∞„Åó„ÅÑ‰æùÈ†ºËÄÖ„ÇíËøΩÂä†
        function addRequester() {
            const name = document.getElementById('newRequesterName').value.trim();
            const avatar = document.getElementById('newRequesterAvatar').value.trim();
            const email = document.getElementById('newRequesterEmail').value.trim();
            const department = document.getElementById('newRequesterDepartment').value.trim();
            
            if (!name) {
                alert('‰æùÈ†ºËÄÖÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const newRequester = {
                id: Date.now().toString(),
                name: name,
                avatar: avatar || 'https://via.placeholder.com/100x100/007AFF/FFFFFF?text=' + encodeURIComponent(name.charAt(0)),
                email: email,
                department: department,
                trustPoints: 0,
                trustLevel: 'low',
                createdAt: new Date().toISOString(),
                totalTasks: 0,
                completedTasks: 0,
                averageCompletionTime: 0
            };
            
            requesters.push(newRequester);
            saveData();
            updateRequesterList();
            hideAddRequesterForm();
            
            showNotification(`${name} „Çí‰æùÈ†ºËÄÖ„Å´ËøΩÂä†„Åó„Åæ„Åó„Åü`);
        }

        // ‰æùÈ†ºËÄÖ‰∏ÄË¶ß„ÇíÊõ¥Êñ∞
        function updateRequesterList() {
            const container = document.getElementById('requesterList');
            if (requesters.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #666; padding: 40px;">‰æùÈ†ºËÄÖ„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</div>';
                return;
            }
            
            container.innerHTML = requesters.map(req => {
                const isCurrent = currentRequesterId === req.id;
                const trustLevelText = req.trustLevel === 'high' ? 'ÊúÄÈ´ò‰ø°È†º' : 
                                      req.trustLevel === 'medium' ? 'È´ò‰ø°È†º' : '‰ø°È†º‰∏≠';
                
                return `
                    <div class="requester-card ${isCurrent ? 'current' : ''}" onclick="selectRequester('${req.id}')">
                        <div class="requester-card-header">
                            <img src="${req.avatar}" alt="${req.name}" class="requester-card-avatar">
                            <div class="requester-card-info">
                                <h4>${req.name}</h4>
                                <p>${req.department || 'ÈÉ®ÁΩ≤Êú™Ë®≠ÂÆö'}</p>
                            </div>
                        </div>
                        <div class="requester-card-stats">
                            <div class="stat-item">
                                <div class="stat-value">${req.trustPoints}</div>
                                <div class="stat-label">‰ø°È†º„Éù„Ç§„É≥„Éà</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${req.completedTasks}</div>
                                <div class="stat-label">ÂÆå‰∫Ü„Çø„Çπ„ÇØ</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${trustLevelText}</div>
                                <div class="stat-label">‰ø°È†º„É¨„Éô„É´</div>
                            </div>
                        </div>
                        <div class="requester-card-actions">
                            <button class="select-btn" onclick="event.stopPropagation(); selectRequester('${req.id}')">
                                ${isCurrent ? 'ÈÅ∏Êäû‰∏≠' : 'ÈÅ∏Êäû'}
                            </button>
                            <button class="detail-btn" onclick="event.stopPropagation(); showRequesterDetail('${req.id}')">
                                Ë©≥Á¥∞
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ‰æùÈ†ºËÄÖ„ÇíÈÅ∏Êäû
        function selectRequester(requesterId) {
            const selectedRequester = requesters.find(req => req.id === requesterId);
            if (!selectedRequester) return;
            
            currentRequesterId = requesterId;
            requester = {
                name: selectedRequester.name,
                avatar: selectedRequester.avatar
            };
            requesterTrustPoints = selectedRequester.trustPoints;
            requesterTrustLevel = selectedRequester.trustLevel;
            
            updateRequesterDisplay();
            updateRequesterList();
            saveData();
            
            showNotification(`${selectedRequester.name} „ÇíÈÅ∏Êäû„Åó„Åæ„Åó„Åü`);
        }

        // ‰æùÈ†ºËÄÖË©≥Á¥∞„ÇíË°®Á§∫
        function showRequesterDetail(requesterId) {
            const selectedRequester = requesters.find(req => req.id === requesterId);
            if (!selectedRequester) return;
            
            document.getElementById('requesterDetailPage').style.display = 'block';
            document.getElementById('requesterDetailName').textContent = selectedRequester.name;
            
            // ‰æùÈ†ºËÄÖË©≥Á¥∞ÊÉÖÂ†±„ÇíÊõ¥Êñ∞
            updateRequesterDetailInfo(selectedRequester);
            updateRequesterStats(selectedRequester);
            updateRequesterTasks(selectedRequester);
        }

        // ‰æùÈ†ºËÄÖË©≥Á¥∞„ÇíÈùûË°®Á§∫
        function hideRequesterDetail() {
            document.getElementById('requesterDetailPage').style.display = 'none';
        }

        // ‰æùÈ†ºËÄÖË©≥Á¥∞ÊÉÖÂ†±„ÇíÊõ¥Êñ∞
        function updateRequesterDetailInfo(requester) {
            const container = document.getElementById('requesterDetailInfo');
            const trustLevelText = requester.trustLevel === 'high' ? 'ÊúÄÈ´ò‰ø°È†º' : 
                                  requester.trustLevel === 'medium' ? 'È´ò‰ø°È†º' : '‰ø°È†º‰∏≠';
            
            container.innerHTML = `
                <div class="requester-detail-header">
                    <img src="${requester.avatar}" alt="${requester.name}" class="requester-detail-avatar">
                    <div>
                        <h3>${requester.name}</h3>
                        <p><strong>ÈÉ®ÁΩ≤„ÉªÂΩπËÅ∑:</strong> ${requester.department || 'Êú™Ë®≠ÂÆö'}</p>
                        <p><strong>„É°„Éº„É´:</strong> ${requester.email || 'Êú™Ë®≠ÂÆö'}</p>
                        <p><strong>‰ø°È†º„É¨„Éô„É´:</strong> ${trustLevelText}</p>
                        <p><strong>ÁôªÈå≤Êó•:</strong> ${new Date(requester.createdAt).toLocaleDateString()}</p>
                    </div>
                </div>
            `;
        }

        // ‰æùÈ†ºËÄÖÁµ±Ë®à„ÇíÊõ¥Êñ∞
        function updateRequesterStats(requester) {
            const container = document.getElementById('requesterStats');
            const relatedTasks = tasks.filter(task => task.requester && task.requester.name === requester.name);
            const completedTasks = relatedTasks.filter(task => task.status === TASK_STATUS.COMPLETED);
            const averageTime = completedTasks.length > 0 ? 
                completedTasks.reduce((sum, task) => {
                    if (task.startedAt && task.completedAt) {
                        const duration = new Date(task.completedAt) - new Date(task.startedAt);
                        return sum + duration;
                    }
                    return sum;
                }, 0) / completedTasks.length / (1000 * 60 * 60) : 0; // ÊôÇÈñìÂçò‰Ωç
            
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${requester.trustPoints}</div>
                    <div class="stat-label">‰ø°È†º„Éù„Ç§„É≥„Éà</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${relatedTasks.length}</div>
                    <div class="stat-label">Á∑è„Çø„Çπ„ÇØÊï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${completedTasks.length}</div>
                    <div class="stat-label">ÂÆå‰∫Ü„Çø„Çπ„ÇØÊï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${Math.round(averageTime * 10) / 10}h</div>
                    <div class="stat-label">Âπ≥ÂùáÂÆå‰∫ÜÊôÇÈñì</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${relatedTasks.length > 0 ? Math.round((completedTasks.length / relatedTasks.length) * 100) : 0}%</div>
                    <div class="stat-label">ÂÆå‰∫ÜÁéá</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${requester.trustLevel === 'high' ? 'üî•' : requester.trustLevel === 'medium' ? '‚≠ê' : 'üå±'}</div>
                    <div class="stat-label">‰ø°È†º„É¨„Éô„É´</div>
                </div>
            `;
        }

        // ‰æùÈ†ºËÄÖÈñ¢ÈÄ£„Çø„Çπ„ÇØ„ÇíÊõ¥Êñ∞
        function updateRequesterTasks(requester) {
            const container = document.getElementById('requesterTasks');
            const relatedTasks = tasks.filter(task => task.requester && task.requester.name === requester.name);
            
            if (relatedTasks.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">Èñ¢ÈÄ£„Çø„Çπ„ÇØ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                return;
            }
            
            container.innerHTML = relatedTasks.map(task => {
                const statusText = task.status === TASK_STATUS.COMPLETED ? 'ÂÆå‰∫Ü' : 
                                 task.status === TASK_STATUS.IN_PROGRESS ? 'ÂÆüË°å‰∏≠' : 'ÂæÖÊ©ü‰∏≠';
                const statusClass = task.status === TASK_STATUS.COMPLETED ? 'completed' : 
                                  task.status === TASK_STATUS.IN_PROGRESS ? 'in-progress' : 'pending';
                
                return `
                    <div class="task-item ${statusClass}">
                        <div class="task-content">
                            <div class="task-title">${task.content}</div>
                            <div class="task-meta">
                                <span class="task-status">${statusText}</span>
                                <span class="task-priority priority-${task.priority}">${task.priority === 'high' ? 'È´ò' : task.priority === 'medium' ? '‰∏≠' : '‰Ωé'}</span>
                                ${task.deadline ? `<span class="task-deadline">ÊúüÈôê: ${new Date(task.deadline).toLocaleDateString()}</span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ‰æùÈ†ºËÄÖË°®Á§∫„ÅÆÊõ¥Êñ∞
        function updateRequesterDisplay() {
            const container = document.getElementById('requesterInfo');
            if (!requester) {
                container.innerHTML = '<div style="text-align: center; color: #666; padding: 10px;">‰æùÈ†ºËÄÖ„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</div>';
                return;
            }

            const trustLevelText = requesterTrustLevel === 'high' ? 'ÊúÄÈ´ò‰ø°È†º' : 
                                  requesterTrustLevel === 'medium' ? 'È´ò‰ø°È†º' : '‰ø°È†º‰∏≠';
            
            container.innerHTML = `
                <div class="requester-item">
                    <div class="trust-points-container">
                        <img src="${requester.avatar}" alt="${requester.name}" class="requester-avatar" id="requesterAvatarImg">
                        <div class="trust-points ${requesterTrustLevel}">${requesterTrustPoints}</div>
                        <div class="trust-level-display ${requesterTrustLevel}">${trustLevelText}</div>
                    </div>
                    <div class="requester-name">${requester.name}</div>
                    <div class="requester-status">‰æùÈ†ºËÄÖ</div>
                </div>
            `;
        }

        // „Çø„Çπ„ÇØ„ÇíËøΩÂä†
        function addTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const deadline = document.getElementById('taskDeadline').value;

            if (!title) {
                alert('„Çø„Çπ„ÇØ„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            const newTask = {
                id: ++taskIdCounter,
                content: title,
                description: description,
                priority: selectedPriority,
                deadline: deadline ? new Date(deadline) : null,
                status: TASK_STATUS.PENDING,
                createdAt: new Date(),
                type: 'manual', // ÊâãÂãïËøΩÂä†„ÅÆ„Çø„Çπ„ÇØ
                requester: requester
            };

            tasks.unshift(newTask);
            tasks = tasks.slice(0, 20); // ÊúÄÊñ∞20‰ª∂„Çí‰øùÊåÅ

            updateTaskList();
            hideAddTaskModal();

            // Áõ£Ë¶ñËÄÖ„Å´ÈÄöÁü•
            notifyWatchers(`Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„Äå${title}„Äç„ÅåËøΩÂä†„Åï„Çå„Åæ„Åó„Åü`, newTask);

            showNotification('„Çø„Çπ„ÇØ„ÇíËøΩÂä†„Åó„Åæ„Åó„ÅüÔºÅ');
        }

        // „Ç¢„Éó„É™Ëµ∑ÂãïÊôÇ„ÅÆÂàùÊúüÂåñ
        function init() {
            // ‰øùÂ≠ò„Åï„Çå„Åü‰ø°È†ºÂ∫¶„ÇíË™≠„ÅøËæº„Åø
            const savedTrustLevel = localStorage.getItem('trustLevel');
            if (savedTrustLevel) {
                trustLevel = parseInt(savedTrustLevel);
            }
            
            // ‰øùÂ≠ò„Åï„Çå„Åü„Çø„Çπ„ÇØ„ÇíË™≠„ÅøËæº„Åø
            const savedTasks = localStorage.getItem('tasks');
            if (savedTasks) {
                tasks = JSON.parse(savedTasks);
            }
            
            // ‰øùÂ≠ò„Åï„Çå„ÅüÊãõÂæÖ„É¶„Éº„Ç∂„Éº„ÇíË™≠„ÅøËæº„Åø
            const savedInvitedUsers = localStorage.getItem('invitedUsers');
            if (savedInvitedUsers) {
                invitedUsers = JSON.parse(savedInvitedUsers);
            }
            
            // ‰øùÂ≠ò„Åï„Çå„Åü‰æùÈ†ºËÄÖ„ÇíË™≠„ÅøËæº„Åø
            const savedRequester = localStorage.getItem('requester');
            if (savedRequester) {
                requester = JSON.parse(savedRequester);
            }
            
            // ‰øùÂ≠ò„Åï„Çå„Åü‰ø°È†º„Éù„Ç§„É≥„Éà„ÇíË™≠„ÅøËæº„Åø
            const savedTrustPoints = localStorage.getItem('requesterTrustPoints');
            if (savedTrustPoints) {
                requesterTrustPoints = parseInt(savedTrustPoints);
                updateTrustLevel();
            }
            
            // ‰øùÂ≠ò„Åï„Çå„Åü‰æùÈ†ºËÄÖ‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„Åø
            const savedRequesters = localStorage.getItem('requesters');
            if (savedRequesters) {
                requesters = JSON.parse(savedRequesters);
            }
            
            // ‰øùÂ≠ò„Åï„Çå„ÅüÁèæÂú®„ÅÆ‰æùÈ†ºËÄÖID„ÇíË™≠„ÅøËæº„Åø
            const savedCurrentRequesterId = localStorage.getItem('currentRequesterId');
            if (savedCurrentRequesterId) {
                currentRequesterId = savedCurrentRequesterId;
                const selectedRequester = requesters.find(req => req.id === currentRequesterId);
                if (selectedRequester) {
                    requester = {
                        name: selectedRequester.name,
                        avatar: selectedRequester.avatar
                    };
                    requesterTrustPoints = selectedRequester.trustPoints;
                    requesterTrustLevel = selectedRequester.trustLevel;
                }
            }
            
            updateTrustDisplay();
            updateTaskList();
            updateInvitedUsersDisplay();
            updateRequesterDisplay();
            updateRequesterList();
        }

        // „Éá„Éº„Çø„Çí‰øùÂ≠ò
        function saveData() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
            localStorage.setItem('invitedUsers', JSON.stringify(invitedUsers));
            localStorage.setItem('requester', JSON.stringify(requester));
            localStorage.setItem('requesterTrustPoints', requesterTrustPoints.toString());
            localStorage.setItem('requesters', JSON.stringify(requesters));
            localStorage.setItem('currentRequesterId', currentRequesterId || '');
        }

        // ÂÆöÊúüÁöÑ„Å´„Éá„Éº„Çø„Çí‰øùÂ≠ò
        setInterval(saveData, 5000);

        // ÂÆöÊúüÁöÑ„Å´„Ç¢„Ç§„Ç≥„É≥„Çµ„Ç§„Ç∫„ÇíÊõ¥Êñ∞Ôºà„É™„Ç¢„É´„Çø„Ç§„É†Á∑äÊÄ•Â∫¶Â§âÂåñÔºâ
        setInterval(() => {
            updateTaskList();
            updateRequesterAvatarSizes();
        }, 30000); // 30Áßí„Åî„Å®„Å´Êõ¥Êñ∞

        // „É¢„Éº„ÉÄ„É´Â§ñ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
        document.getElementById('addTaskModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideAddTaskModal();
            }
        });

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´ÂàùÊúüÂåñ
        window.addEventListener('load', init);
    </script>
</body>
</html>